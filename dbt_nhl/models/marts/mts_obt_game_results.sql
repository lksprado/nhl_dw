with
games as (
    select * from {{ ref('int_fct_games') }}
),
teams as (
    select * from {{ ref('int_dime_teams') }}
)
select
t1.game_id,
t1.season_id,
t1.game_date,
t1.start_time_date_eastern,
t1.start_time_date_gmt_minus_3,
t1.arena,
t1.city,
t1.game_type,
t1.game_number,
t1.outcome_last_period_type,
t1.outcome_ot_periods,
t1.referee_1,
t1.referee_2,
t3.team_trid as home_team_trid,
t2.team_trid as away_team_trid,
t3.short_name as home_team_shortname,
t2.short_name as away_team_shortname,
t3.full_name as home_team_fullname,
t2.full_name as away_team_fullname,
t3.is_active as home_team_active,
t2.is_active as away_team_active,
t1.home_score,
t1.away_score,
t1.home_sog,
t1.away_sog,
t1.home_score_period_1,
t1.home_score_period_2,
t1.home_score_period_3,
t1.home_score_period_4,
t1.home_score_period_5,
t1.away_score_period_1,
t1.away_score_period_2,
t1.away_score_period_3,
t1.away_score_period_4,
t1.away_score_period_5,
t1.home_shots_period_1,
t1.home_shots_period_2,
t1.home_shots_period_3,
t1.home_shots_period_4,
t1.home_shots_period_5,
t1.away_shots_period_1,
t1.away_shots_period_2,
t1.away_shots_period_3,
t1.away_shots_period_4,
t1.away_shots_period_5,
t1.away_hits,
t1.home_hits,
t1.away_faceoff_winning_pctg,
t1.home_faceoff_winning_pctg,
t1.away_powerplay_pctg,
t1.home_powerplay_pctg,
t1.away_penalty_minutes,
t1.home_penalty_minutes,
t1.away_blocked_shots,
t1.home_blocked_shots,
t1.away_giveaways,
t1.home_giveaways,
t1.away_takeaways,
t1.home_takeaways
from games t1
left join teams t2
on t1.away_team_id = t2.team_id
left join teams t3
on t1.home_team_id = t3.team_id
